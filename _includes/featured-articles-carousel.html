<!-- ===================================
     Featured Articles Carousel
     記事のサムネイルが左から右に流れるセクション
     =================================== -->

<section class="featured-articles-carousel">
    <div class="carousel-container">
        <div class="carousel-track" id="carouselTrack">
            {% comment %}
            featuredタグが付いた記事、または最新の記事を取得
            thumbnail_imageが設定されている記事のみ表示
            {% endcomment %}
            
            {% assign featured_posts = site.posts | where_exp: "post", "post.featured == true" %}
            
            {% comment %}featuredが少ない場合は最新記事を追加{% endcomment %}
            {% if featured_posts.size < 6 %}
                {% assign featured_posts = site.posts | slice: 0, 10 %}
            {% endif %}
            
            {% comment %}画像を2回繰り返して無限スクロール実現{% endcomment %}
            {% for i in (1..2) %}
                {% for post in featured_posts limit:10 %}
                    {% if post.thumbnail_image %}
                    <div class="carousel-item">
                        <a href="{{ post.url | relative_url }}" class="carousel-link">
                            <div class="carousel-image-wrapper">
                                <img src="{{ post.thumbnail_image | relative_url }}" 
                                     alt="{{ post.title }}" 
                                     class="carousel-image"
                                     loading="lazy">
                                
                                <!-- ホバー時のオーバーレイ -->
                                <div class="carousel-overlay">
                                    <div class="carousel-content">
                                        <p class="carousel-date">
                                            {{ post.date | date: "%Y.%m.%d" }}
                                        </p>
                                        <h3 class="carousel-title">
                                            {{ post.title }}
                                        </h3>
                                        {% if post.subtitle %}
                                        <p class="carousel-subtitle">
                                            {{ post.subtitle }}
                                        </p>
                                        {% elsif post.excerpt %}
                                        <p class="carousel-excerpt">
                                            {{ post.excerpt | strip_html | truncatewords: 15 }}
                                        </p>
                                        {% endif %}
                                        <div class="carousel-tags">
                                            {% for tag in post.tags limit:3 %}
                                            <span class="carousel-tag">{{ tag }}</span>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </a>
                    </div>
                    {% endif %}
                {% endfor %}
            {% endfor %}
        </div>
    </div>
</section>
---
layout: post
title: 量子技術を用いた運搬経路問題の最適化
thumbnail_image: /img/posts/quantum-1.png
---

# 量子技術を用いた運搬経路問題の最適化
塩野義製薬株式会社 DX推進本部 データサイエンス部所属の田島です。
普段はデータサイエンティストとして、感染症の流行予測モデル構築、ウェアラブルデバイスを用いたストレス予測、営業リソースアロケーション最適化など、Modeling&Simulationや最適化計算を主軸として幅広く取り組んでいます。
現在、DX推進本部では、最先端技術である量子コンピュータおよびその周辺技術を実務で活用するための取り組みを推進しています。この取り組みを進める中で、私たちは医薬情報担当者（MR: Medical Representative）の施設訪問計画の最適化という課題に着目しました。SHIONOGIでは、従来の強みである感染症領域に加えて、中枢神経系領域を新たな注力領域として積極的に展開しています。このように取扱う製品の幅が広がる一方で、医療現場に提供する情報の質は向上し続けなければなりません。この重要課題に対して、最先端技術の力で少しでも貢献したいと考え、本研究に取り組むことにしました。

---

## 医薬情報担当者による情報提供活動

医薬品業界では、生命や健康に密接に関連する医療用医薬品を取り扱っているため、製品の適正使用に繋がる情報提供が必要不可欠です。この医療用医薬品の情報提供を担うのがMRであり、MRの活動が製薬企業による情報提供の主手段となります。MRによる情報提供活動は、主に医療施設へ直接訪問することで実施されます。多くのMRは多数の医療施設を担当しており、施設訪問計画を効率的に策定することが重要になります。しかしながら、地域によっては施設間の長距離移動、訪問時間等といった、複数の制約条件の下で施設訪問計画を策定する必要があるため、最適な訪問計画を立てるには、通常、大規模な演算が必要になります。

---

## 量子アニーリングによるVRPの求解

運搬経路問題（VRP: Vehicle Routing Problem）は、複数の車両で複数の配送先を訪問し、荷物の配達（または集荷）を行う際の移動コストが最小になるような訪問経路を求める最適化問題です。VRPの求解方法としてこれまでに様々な手法が提案されていますが、近年、量子アニーリングによる求解が注目されています。量子アニーリングは、最適化問題に特化した量子アルゴリズムの1つで、従来のコンピュータによる最適化手法と比較して、問題によってはより高速に最適解を求めることができると考えられています。本研究では、MRを車両、各医療施設を配送先とみなすことで、MRの訪問計画最適化をVRPとして捉え、量子アニーリングによる求解を試みました。

<img src="{{ "/img/posts/quantum-1.png" | relative_url }}" alt="量子アニーリングによるVRPの概念図" width="600" height="400">

---

## 定式化と制約条件

量子アニーリングによってVRPを解くためには、対象の問題を「二次制約なし二値最適化」（QUBO: Quadratic Unconstrained Binary Optimization）で表現する必要があります。今回、MRの施設訪問計画をVRPとして見なし、後述する制約条件の下でMRの総移動距離を最小化することを目指します。そうすると、この問題はQUBOで表現することができ、これが目的関数になります。

<img src="{{ "/img/posts/quantum-2.png" | relative_url }}" alt="QUBO目的関数の定式化" width="450" height="300">

この時、Nは訪問先の医療施設数、Lは1人のMRによって訪問可能な医療施設の最大数、Kは担当MRの人数、D_(j_a→j_b)は施設aから施設bまでの距離で、x_(i,j,k)∈{0,1}は、MR kがi番目に訪問する医療施設として施設jが選ばれるかどうかを表すためのバイナリ変数です。

ここに以下の5つの制約条件を設定して、最適化を実行しました。

1. MR kがi番目に訪問する医療施設は1施設のみとする。
2. 全てのMRは、特定の拠点より出発し、同じ拠点へ戻ってくる。
3. 出発地点を除く施設jは、いずれかのMRによってちょうど1回だけ訪問される（同一施設への複数訪問を回避する）。
4. いくつかの施設jについては、訪問できない時間(i_t)が存在する。
5. 各MRの総移動コストは、各施設間を移動する際の移動コストの総和以下とする。

---

## 結果と今後の展望

今回は、MR数が5人、訪問施設数が50施設という条件で最適化を行い、制約条件を満たして最適化された訪問経路を4秒という短時間で得ることができました。社内では実データを使用していますが、実データは機密事項に該当するために、本研究ではダミーデータを使用しました。

<img src="{{ "/img/posts/quantum-3.png" | relative_url }}" alt="最適化された訪問経路の結果" width="300" height="200">

今回の発表ではGPUベースのアニーリングマシンであるFixstars Amplify Annealing Engine（AE）を使用しましたが、すでに量子コンピュータ実機を用いた検証についても実施が完了し、今後発表予定です。

MR数が5人という問題設定は「1人のMRによる1週間（5営業日）の訪問計画」とみなすこともできます。このような問題設定においては、診療の妨げとならないよう訪問時間帯の制約に加え、訪問不可な曜日などについても制約条件として含めることができます。このように、MRの施設訪問の実態を踏まえた様々な場面を想定したさらなるモデル拡張が可能だと考えています。他にも、MRの個々のスキルなども組み入れることで、施設訪問時における情報提供の品質向上への貢献も期待できます。

今回は、量子技術の1つであるアニーリングを用いた医薬情報担当者の施設訪問計画の最適化事例についてご紹介しました。本技術に限らず、量子技術を含めた様々な最適化手法を駆使しながら、これからも社内外の課題を解決すべく取り組んでいきたいと思います。

<img src="{{ "/img/posts/quantum-5.png" | relative_url }}" alt="受賞写真（著者一同）" width="900" height="600">

受賞写真：著者一同（左から田島 遼太郎、小林 雅行、木口 亮、北西 由武）

---

## 受賞のお知らせ

本研究成果は、2025年5月27日に2025年度人工知能学会全国大会（第39回）にて発表を行い、ポスター発表部門にて**全国大会優秀賞**を受賞しました。

[人工知能学会受賞者【全国大会優秀賞】](https://www.ai-gakkai.or.jp/about/award/jsai_award-conf/#CONFERENCE)

**発表タイトル：** 量子アニーリングを用いた時間窓制約付き運搬経路問題（VRPTW）の求解による医薬情報担当者の施設訪問計画の最適化

**著者名：** 田島 遼太郎、小林 雅行、木口 亮、北西 由武

**DOI：** [https://doi.org/10.11517/pjsai.JSAI2025.0_1Win419](https://doi.org/10.11517/pjsai.JSAI2025.0_1Win419)

---

### データエンジニアリング人材の募集
データサイエンス部では、
データエンジニアリング職の募集を行っています。

データ関連のスキルやご経験をヘルスケア領域の
データ基盤の構築・運用で活かしてみたい方は、
以下のリンクから募集内容の詳細を確認ください。
皆さまからのご応募をお待ちしております。